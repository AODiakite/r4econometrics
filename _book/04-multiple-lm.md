# La régression linéaire multiple{#multiple-lm}

Dans le chapitre précédent, nous avons cherché à expliquer une variable $y$ par une seule variable quantitative $X$ grâce à une fonction affine. Le modèle linéaire multiple est une généralisation du cas simple, en effet au lieu d’avoir une seule variable explicative nous en aurons plusieurs en nombre fini bien sûr, d'où le nom de régression lineaire multiple.
Les jeu de données [`heart_data`](Data/heart.data.csv) utilisé dans ce chapitre vient d’une enquête sur 498 villes, on a recueilli les données dans chaque ville en pourcentage de personnes atteintes de maladies cardiaques (`heart.disease`), qui fument(`smoking`) et qui se rendent au travail en vélo(`biking`). On cherche les facteurs qui pourraient avoir une influence sur les maladies cardiaques.


```r
# Load data
heart_data <- read.csv("Data/heart.data.csv",
                       header = T,sep = ",")
```

## Modélisation mathématique
La relation affine dans le cas de la régression linéaire multiple est de la forme suivante :
```{=tex}
\begin{equation}
y_i = \beta_0 + \beta_1x_{i1} + \beta_2x_{i2} +\dots+\beta_px_{ip}+\epsilon_{i}\;\; 
avec\;i\in\{1,2,3\dots,n\}
\end{equation}
```

*   $y_i$ représentent la $i$ème valeur de la variable dépendantes $y$.
*   $x_{ij}$ représente la mesure de la $i$ème observation de la variable explicative $X_j$
*   les $\beta_j$ sont les paramètres inconnus du modèle à estimer
*   $\epsilon_i$ représente le bruit associé à la $i$ème observation\

L'équation précédente peut être écrite sous une forme matricielle de cette manière :\

\begin{equation}
y = X\beta +\epsilon
(\#eq:lm-multiple)
\end{equation}

avec :
\begin{equation}
y = \begin{pmatrix}y_1\\y_2\\\vdots\\y_n \end{pmatrix} \hspace{0.2cm} 
X = \begin{pmatrix}
   1 & x_{11} & x_{12} & \dots &x_{1p}\\
   1 & x_{21} & x_{22} & \dots &x_{2p}\\
   \vdots &\vdots&\vdots & &\vdots\\
   1 & x_{n1} & x_{n2} & \dots &x_{np}
   \end{pmatrix} \hspace{0.2cm}
\beta = \begin{pmatrix}\beta_0\\
   \beta_1\\
   \vdots\\
   \beta_n \end{pmatrix} \hspace{0.2cm}
\epsilon = \begin{pmatrix}
   \epsilon_1\\
   \epsilon_2\\
   \vdots\\
   \epsilon_n \end{pmatrix} \hspace{0.2cm}
\end{equation}

Dans notre jeu de données `heart_data`, $y$ représente le pourcentage de personnes atteintes de maladies cardiaques (`heart.disease`), $X_1$ le pourcentage de personnes qui se rendent au travail en vélo(`biking`) et $X_2$ le pourcentage de personnes qui fument(`smoking`). 


## Estimateurs des moindres carrés ordinaires ($MCO$)

Comme dans la régression linéaire simple, l'estimateur $\hat\beta$ des moindres carrés de $\beta$ est la quantité :\

```{=tex}
\hat\beta =\operatorname*{argmin}_{(\beta_0,\beta_1\dots,\beta_p)}
\sum\limits_{i=1}^{n}{\Bigg(y_i - \sum\limits_{j=0}^{p}\beta_jx_{ij}\Bigg)}^2\\ 
= \operatorname*{argmin}_{\beta \in \mathbb{1}\times\mathbb{R}}\big(y-X\beta\big)'\big(y-X\beta\big) 
``` 

La solution de cette équation est la suivante :\  
$$
\hat\beta = (X'X)^{-1}(X'y)
$$  
Une section entière dédiée au calcul de cet estimateur se trouve dans l’ouvrage @lm_simple.

## Application du modèle linéaire multiple avec R

Le langage R permet d'entraîner le modèle linéaire multiple grâce à la fonction `lm()`. Pour indiquer à la fonction que nous sommes dans le cas d’une régression multiple, l’argument `formula` doit recevoir `y~X1+X2+...+XP` et pour notre exemple `heart.disease~biking+smoking`.
Lors qu’on précise l’argument data de la fonction lm et que les données ne contiennent que les variables à étudier, l’argument formel peut dans ce cas recevoir juste `y~.`. En Pratique, pour notre jeu de données `heart_data`, ces deux écritures sont équivalentes :

```r
lm_multiple <- lm(formula = heart.disease~biking+smoking, data = heart_data)
lm_multiple <- lm(formula = heart.disease~., data = heart_data)
```

On peut afficher le résumé de l'entraînement de notre modèle avec la fonction `summary()`. Nous avons déjà appris la signification des éléments de la sortie de cette fonction dans la section\@ref(OLS) du chapitre \@ref(simple-lm).


```r
# Resume du model
summary(lm_multiple)
#> 
#> Call:
#> lm(formula = heart.disease ~ ., data = heart_data)
#> 
#> Residuals:
#>     Min      1Q  Median      3Q     Max 
#> -2.1789 -0.4463  0.0362  0.4422  1.9331 
#> 
#> Coefficients:
#>              Estimate Std. Error t value Pr(>|t|)    
#> (Intercept) 14.984658   0.080137  186.99   <2e-16 ***
#> biking      -0.200133   0.001366 -146.53   <2e-16 ***
#> smoking      0.178334   0.003539   50.39   <2e-16 ***
#> ---
#> Signif. codes:  
#> 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#> 
#> Residual standard error: 0.654 on 495 degrees of freedom
#> Multiple R-squared:  0.9796,	Adjusted R-squared:  0.9795 
#> F-statistic: 1.19e+04 on 2 and 495 DF,  p-value: < 2.2e-16
```
On constate que pour toutes les variables y compris l’Intercept, les p-values sonts très inférieures à $5\%$, on rejette alors l'hypothèse $H_0$ insinuant que $\beta_j$ est nulle avec un niveau de confiance de $95\%$.\
De plus, le coefficient d’ajustement $R^2$ est de $0.9796$, soit un score de $97,96\%$ pour notre modèle ce qui est un très bon résultat. 

Lors de la régression multiple, on peut s’intéresser à l'effet de l’interaction entre les variables explicatives sur la variable $y$. L’étude de cette interaction peut se faire dans notre exemple par la `formula` `heart.disease~biking+smoking+biking:smoking` où la troisième composante `biking:smoking` représente l’interaction entre le pourcentage de personnes qui se rendent au travail en vélo et le pourcentage de personnes qui fument. Cette écriture peut prendre une forme plus simple telle que `heart.disease~biking*smoking`. `lm_multiple` devient alors :


```r
lm_multiple <- lm(formula = heart.disease~biking*smoking, data = heart_data)
summary(lm_multiple)
#> 
#> Call:
#> lm(formula = heart.disease ~ biking * smoking, data = heart_data)
#> 
#> Residuals:
#>      Min       1Q   Median       3Q      Max 
#> -2.20619 -0.44862  0.02892  0.44099  1.94142 
#> 
#> Coefficients:
#>                  Estimate Std. Error t value Pr(>|t|)    
#> (Intercept)    15.0527397  0.1248112 120.604   <2e-16 ***
#> biking         -0.2019916  0.0029472 -68.536   <2e-16 ***
#> smoking         0.1740065  0.0070359  24.731   <2e-16 ***
#> biking:smoking  0.0001177  0.0001653   0.712    0.477    
#> ---
#> Signif. codes:  
#> 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#> 
#> Residual standard error: 0.6544 on 494 degrees of freedom
#> Multiple R-squared:  0.9796,	Adjusted R-squared:  0.9795 
#> F-statistic:  7922 on 3 and 494 DF,  p-value: < 2.2e-16
```

Dans la nouvelle sortie on peut voir une nouvelle variable `biking:smoking` dont la p-value est très proche de $5\%$ donc par prudence, on ne peut rejeter l'hypothèse nulle $H_0$ associée au $\beta_j$ de cette variable. Autrement dit, on peut se passer de l'interaction entre `biking`($X_1$) et `smoking`($X_2$) dans l’explication de `heart.disease`($y$).

## Représentations graphiques

Lorsque le nombre de variables explicatives dépasse 2, il est impossible de représenter sur un même graphes le nuage de point formé par y, en effet la dimension physique maximale est de 3. 
Il existe plusieurs packages qui donnes des représentations assez significatives en deux dimensions du modèle lineair multiple tel que `car`^[package car : https://cran.r-project.org/web/packages/car/index.html].

### Nuage de points 3D
Pour notre exemple nous pouvons faire une représentation interactive en 3 dimensions de nos variable avec la fonction `plot_ly()` du package `plotly`.


```r
library(plotly)
figure <- plot_ly(heart_data, x = ~biking, y = ~smoking, z = ~heart.disease, 
   color =~heart.disease
  ) %>%
  add_markers() %>%
  layout(
    scene = list(xaxis = list(title = 'biking'),
        yaxis = list(title = 'smoking'),
        zaxis = list(title = 'heart.disease'))
        )
figure
```

<div class="figure">

```{=html}
<div id="htmlwidget-b436ec305ee1586e3634" style="width:480px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-b436ec305ee1586e3634">{"x":{"visdat":{"5ac5f09c800":["function () ","plotlyVisDat"]},"cur_data":"5ac5f09c800","attrs":{"5ac5f09c800":{"x":{},"y":{},"z":{},"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"biking"},"yaxis":{"title":"smoking"},"zaxis":{"title":"heart.disease"}},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[30.8012457056902,65.129215165507,1.95966453105211,44.8001956157386,69.4284536754712,54.4036255460232,49.0561619559303,4.78460420155898,65.7307882993482,35.2574489386752,51.8255674857646,52.9361971635371,48.7674784869887,26.1668007872067,10.5530749158934,47.163716411218,61.6852562502027,33.9443941223435,39.6976243732497,63.1246982915327,28.5101294391789,18.5259731053375,24.4794696941972,18.3586463392712,30.3881837436929,52.9852197542787,60.5094481855631,45.2471103458665,48.5970443519764,25.139770812355,44.1730948546901,61.1469464134425,27.2678982103243,49.5270998533815,20.1972059831023,18.811227961909,67.3507646308281,29.9044753648341,14.0117597882636,45.8154881536029,31.4772513112985,17.108203580603,9.6650824546814,23.9330049781129,22.6363011505455,27.2474766909145,20.7896015481092,46.6137151229195,28.6226321943104,21.1274982518516,68.5743485274725,41.6843666564673,69.8795926403254,9.8172769928351,4.37928021745756,28.6103779766709,21.4600155539811,27.6016558962874,57.2305039279163,26.3972817705944,39.0104795377702,11.5274866824038,17.6842870265245,19.9352527754381,42.3100401284173,1.11915412219241,23.2768214615062,14.9658160931431,30.6633499544114,22.9251827755943,59.7703079869971,70.4560608374886,21.7503852020018,49.3606863180175,4.4872418534942,14.6932691922411,40.6116277654655,8.76419749297202,56.7254120912403,60.5511489589699,64.3848925842904,20.2627977221273,30.5200864141807,30.4615424578078,3.70589388720691,15.0824688239954,30.9978419430554,14.6254110718146,28.1030612471513,34.6802410804667,6.94746344955638,26.8606620482169,41.0193228516728,31.9327382529154,69.8771469001658,63.0298536731862,21.349999321159,3.81133785005659,67.5141064450145,12.5808934387751,61.2321972334757,64.3323040795512,31.8724393374287,11.9365617111325,52.360268110875,22.5166377252899,49.7648216411471,22.7926358953118,49.7487477194518,68.204122106079,15.1851012306288,58.0469012488611,69.499688426964,2.61613450478762,2.13634340045974,25.7715705316514,11.6156457848847,17.1974562201649,27.6816619285382,9.64809583639726,65.6219560927711,46.5562282288447,48.300472181756,15.1412918115966,71.5793510554358,4.68124972516671,22.4767227517441,49.2962005212903,17.6481354166754,9.41377807455137,64.9156681126915,3.95036719692871,67.3424570639618,71.2389548039064,70.3238783087581,28.4249012758955,73.7137324055657,56.0580316432752,21.5881990026683,16.2761608348228,26.9886899320409,11.326814383734,55.5805840911344,50.6038023489527,60.4017393402755,71.486750644166,37.9785071178339,48.6921149003319,40.0164002100937,32.1485525486059,12.3182829096913,31.6596669042483,55.841893020086,28.8269527466036,55.472286962904,54.354033573065,70.3316988674924,54.0626091542654,59.5756452921778,2.81820416497067,30.4603349822573,22.3434495115653,14.6968860193156,70.902815385256,35.3351132106036,72.1737664481625,44.698216705583,70.3613663050346,7.61908389721066,29.6736335102469,28.4856830816716,67.4232913511805,10.1450691996142,59.9899041163735,38.1550145540386,15.4660098161548,73.767713482026,31.1796291945502,5.20161100523546,50.249614270404,60.9401407171972,20.0686735860072,41.2112147207372,72.3948556315154,10.6109690801241,45.5798356593587,29.6585058136843,40.0568538974039,5.51029993640259,32.0565294623375,46.8428696957417,42.425006955862,31.2123740906827,13.1766278850846,33.7797390436754,70.6900834068656,60.2849509618245,16.0036051468924,39.6772190323099,12.8851852891967,35.0234504905529,10.3437532177195,20.6408925140277,63.2380372099578,23.9845649180934,44.0148973460309,67.1279237791896,36.5380497784354,7.83148090029135,40.3954008584842,16.2499144631438,47.5846611303277,15.4813624434173,70.0851956680417,1.33048494858667,61.5426922952756,23.0977712832391,65.0699169375002,71.0145415738225,64.0659824782051,61.1527601010166,22.6723675089888,49.728740000166,35.4807941829786,59.4618851994164,31.6975925634615,62.7721077464521,58.6685423534364,25.2541404319927,22.7227009003982,1.6169222118333,10.353647894226,44.7215863247402,29.224098384846,66.1115927351639,46.7284881533124,39.1724266437814,9.93761745002121,61.39384520147,21.6082284310833,6.28361039049923,61.4361362219788,1.25784111954272,4.69986254675314,54.9382231216878,7.74903035117313,49.5634244126268,29.7314032949507,45.7162665440701,47.5373205319047,35.7260155789554,35.9122514100745,26.9199898936786,34.1625080006197,51.900538188871,73.1431462625042,52.5508858608082,10.6640136488713,34.634851064533,37.6931892358698,72.4216793971136,30.1614847662859,67.1214054236189,10.2619999106973,17.5257504764013,66.8400138099678,70.2997394111007,34.2295901230536,42.5948663330637,73.9872368341312,69.3108289442025,38.6366579122841,24.6993560022675,55.3702532975003,32.1702136420645,67.7796326996759,16.0577241280116,39.3332168255001,37.6651898175478,28.4802457373589,73.9329095315188,61.3139714226127,67.8221951532178,1.46630063792691,61.9255107524805,25.6650042068213,36.2376075596549,45.4576067663729,49.0229587387294,63.7994281756692,4.4703256348148,47.6958663514815,4.34142445819452,66.971620305907,34.0326458159834,13.625346488785,54.821432761848,18.2055668612011,51.6927011022344,7.4806367685087,47.3552274573594,38.2042903662659,33.742643035017,40.5550150773488,70.2085961475968,26.1550093702972,17.7517226459458,71.8470439156517,60.0219793892466,60.2703899079934,33.9222053419799,43.3005190109834,22.8915891386569,57.095670576673,40.1240485799499,37.3325380911119,32.6343734497204,43.9093414950185,15.48999926541,52.0340811908245,3.96052612178028,61.303891339805,56.3675117343664,34.5300511391833,70.9505577576347,44.5727705368772,9.81641744915396,14.2426948198117,15.1373845990747,39.9054890270345,13.7306901072152,51.5636827824637,74.0110799190588,13.9398645106703,36.3748615994118,14.732988783624,6.17865379760042,8.12895551556721,9.72775917453691,20.2267735414207,46.0208463161252,33.2846188992262,19.9090008041821,8.63364275265485,50.8980308119208,1.57645198423415,10.3891926649958,28.8963125529699,68.0294251767918,5.4717883374542,48.7778512295336,61.3566911639646,64.1739308475517,2.97716030431911,69.992341552861,65.9637658153661,19.3745530387387,57.9950694967993,9.66173528600484,24.953993474599,62.0610524588265,49.8887961548753,69.7761910757981,29.5787421655841,59.869018277619,19.0714879781008,20.803893960081,2.63393461238593,39.9440847574733,48.5476801525801,26.3320300895721,15.34719364997,74.5837791184895,61.5349933765829,19.6513348566368,23.3155464474112,14.7002121852711,13.3777008722536,32.4846260128543,39.2468995014206,8.52230984391645,37.177186511457,70.7006827169098,68.2127329288051,31.7144633135758,65.2017131987959,64.3769175633788,67.2567547974177,21.537676087115,63.5967268142849,39.9930102946237,70.5789680373855,54.1013244227506,22.3582882871851,60.5846146326512,61.296240680851,41.4432842438109,58.4304327131249,71.6703170277178,61.0081494231708,69.6717817769386,19.3132059341297,38.1668654815294,24.7603190792724,12.9495585775003,17.9663632703014,4.15849618520588,50.8379662688822,8.79657230013981,27.4239961532876,5.78273314004764,4.44566782005131,30.1207264619879,29.047919514589,26.7232924848795,38.1165601396933,45.8598548769951,62.0210494082421,6.05733608501032,4.73134100809693,25.76723351283,25.9069973519072,71.9305769922212,57.9784063100815,21.822555151768,15.3719377154484,67.4717587050982,64.4854188608006,35.7366666290909,6.32421381911263,64.0337511063553,66.0155022023246,3.22029086994007,36.3281938806176,29.8665764629841,57.4759249272756,18.1267837937921,31.8473085220903,63.7531045982614,30.5194436516613,74.2058160975575,33.0202465881594,22.5307610128075,2.01030760491267,11.0990216452628,25.3016494484618,33.1571373445913,28.5699412431568,60.0317472396418,18.951146280393,24.7279817806557,74.9071108056232,10.5301246619783,74.2104944665916,36.2905358639546,55.1987769003026,57.0446093953215,68.6589061198756,40.3174581928179,31.417332012672,71.4404151439667,34.8365794606507,39.3498486201279,73.8481672392227,40.7648476464674,60.6304155541584,74.508778901305,56.210806039162,11.6580285350792,6.29505080869421,60.5873550656252,56.1515430798754,74.2219909494743,25.4430472096428,36.3683179509826,25.8876933013089,59.3502525840886,11.8834469150752,4.81705831596628,7.58214340172708,54.1810021647252,33.2620148714632,36.0862197396345,55.6639432017691,22.7196606057696,41.1789909126237,22.021892959252,69.9279625099152,41.642072155606,70.1944107995369,50.8319080262445,68.8840651274659,21.5992304622196,47.6604395853356,45.0972026577219,8.27974338829517,42.3458634307608,30.7742540906183],"y":[10.8966080237878,2.21956317569129,17.5883305108873,2.80255887506064,15.9745045953896,29.3331755213439,9.06084577110596,12.8350208034972,11.9912972834427,23.2776834309334,14.4351183790714,25.0748685661238,11.0232709712582,6.64574954903219,5.99050630908459,14.0978371595265,16.8408167293528,5.75859518698417,12.6628694300307,22.9174799942411,14.8551063596969,26.4049774003215,26.9249606817029,23.4319567959756,16.9860863648355,27.6890269808937,3.98196209932212,2.13747529429384,10.3884264326189,5.8363727593096,3.96760574460495,27.7834059677552,16.8532932157395,15.2497308164602,10.3314894742798,16.7534420299344,23.8737267946126,24.5845499070128,21.0121418361086,4.71612688153982,22.1658254801296,1.35287826054264,3.50429632351734,4.18586919049267,13.6789828254841,13.3797767800279,19.455428589019,9.24933256942313,12.4827338671312,18.9413482922828,1.80470360477921,13.0672050447902,17.3516599001596,23.8189948870568,20.6629713529255,1.14796205563471,22.9760018186644,4.38838035438675,12.8049999531358,7.76393045228906,0.767680134158581,6.73962196311913,8.27800910745282,6.0764382998459,8.41239664924797,19.5503582581878,14.306634879671,12.8691531609511,16.6632038237294,24.5987872511614,8.70076921628788,12.7407108863117,18.8575106594944,23.2094801891362,23.4189999882365,17.8743935709354,25.9937106202124,3.89904036093503,16.1809773887508,18.0652019373374,10.5295309454668,11.1787829748355,12.4334774210583,29.8608106252505,21.4941885978915,16.6152001309674,29.0164263551123,6.79834619548637,14.7313504790654,8.63810499710962,26.1056582580786,16.7194132083096,12.9991873144172,28.1828730357811,26.3311967340996,22.2471319455653,12.8558534980984,17.7237881793408,26.9553999132477,16.9897825403605,4.61355045193341,29.4237378041726,16.2418978252681,3.48656715557445,19.8410769413458,7.69517289474607,3.57294409489259,9.81682860350702,20.4918307416374,2.19294452201575,14.5203620839166,15.7135850129416,23.16787482379,4.31908037047833,25.8401302666171,28.5403472586768,6.34552890877239,20.7334558584262,18.637008534628,8.37003831728362,14.1066234665923,26.8937498218147,12.0117869512178,7.89374973147642,18.9378854879178,10.9882818640908,25.9723232801771,5.08878808107693,27.1925635932712,8.60853779083118,10.889390592929,6.35957962193061,16.6226193103939,25.194151793723,26.2334742831299,20.2084485548548,14.101652235724,8.20611587178428,2.57349493331276,3.46344909677282,15.8833259673556,9.23065494350158,7.67130744655151,28.9184712404385,24.8321409651544,21.6373684086138,13.9453442961676,23.5640880891588,7.81163491180632,0.969084335607477,26.890805850504,21.3995087156072,2.24871616996825,11.409866627655,5.26743781485129,16.3415201937314,15.0588637106121,20.3888136219466,24.7926380763529,23.2461404720088,2.5256544156,23.20464246138,9.8316822310444,29.9140032049036,9.14750202500727,15.2736628410639,10.0025889354292,20.339915018063,26.6615228859009,2.3967956417473,12.66280359542,28.6574310882716,11.3175196533557,25.4558391306782,20.1042220976669,11.5711483737687,16.1513315930497,5.56844133406412,4.35990317282267,4.12905912089627,21.8644958924269,11.9294172825757,4.15144022356253,7.5198372004088,19.301515463274,20.6168514572782,12.151898999582,16.5064944132464,17.8842192681041,12.4794809161685,27.3216485675657,10.9547393462854,7.7973828415852,9.98746690736152,0.965390337398276,22.7107707114192,15.108140233322,19.8941489032004,10.2721672424814,25.2101824630518,22.6640372866532,27.6468492562417,15.384138373076,20.5047412213171,7.61211691831704,6.57966209494043,5.82036349910777,2.05288312886842,26.8269708742155,7.02746019489132,28.3617369089043,29.4683524053544,18.81520122441,10.382645549369,28.7937440297101,12.8374854150461,0.907361074001528,1.4876797052566,15.281905519776,28.4724463752937,2.19005356181879,28.7353995363228,3.49454244342633,15.8501561826561,18.8075340919895,23.1906637301436,15.2398175458657,19.5857407108415,7.16895189217757,8.28825065819547,1.45843680913094,16.0131718139164,7.2730788316112,27.3570273249643,18.6293941111071,8.4995460548671,17.5563764445251,22.342603052035,22.9195491997525,9.34883572126273,20.1753292536596,24.4659137886483,15.1309518812923,9.85993658460211,13.0462164626224,8.38701920292806,16.2590212804498,23.3339016346727,23.8302604355849,20.0742952565197,8.91576815152075,18.514836531016,11.5309853324434,24.4145881027216,27.3240290055983,11.2752757231938,13.8796797289979,16.4896077291341,4.92269452894107,26.2662578930613,4.24882652994711,6.61104556033388,8.47848235187121,26.8565236154245,4.76389414665755,0.525849992525764,6.42373425152618,17.7648413719144,26.2857437839266,16.9157390920445,4.65573667979334,18.2480097603984,4.60396603157278,17.2038509787526,5.01751488586888,15.1993371247081,19.1118899837602,15.1034692110261,24.9718414458912,17.3199216009816,26.5264341385337,16.8076135774609,26.8826561163878,28.206910423236,26.3258096015779,23.2615381949581,20.9340927724261,25.7596081431257,3.22809541865718,29.1247241867241,4.35536746692378,28.3878511327785,8.03298107278533,24.2198387398385,13.0622366986936,1.41671410226263,10.6239231541986,15.947601681808,19.1996173465159,19.4392334739678,15.3457820230396,23.5397917316295,14.0819165648427,2.78286459378432,13.7516893194988,7.44223185582086,3.48240262363106,13.0407690658467,4.28681039414369,8.78615434363019,24.3928491845727,8.28507479932159,2.40116281516384,3.29116378747858,13.9695702446625,12.7516464238288,13.7179208485177,26.0620819617761,19.543061702163,16.2070389311993,27.4715448273346,15.4111217031023,17.5203571716556,16.7816631674068,3.52117300021928,17.1550494199619,18.0027013602667,26.7242730644066,3.28128236613702,19.7205943424487,14.2177349533886,23.3450455213897,18.8543469166616,27.2540441974998,25.3954955111258,19.4709191604052,15.546870135935,5.88935832912102,15.2972538101021,28.1769617814571,18.0521328845061,17.305040004896,19.0605707267532,4.3829289120622,29.8252592554782,9.06127311568707,23.6915083510103,24.2375830665696,13.2735593908001,16.0808893769281,27.7454918875592,17.9649971266044,19.0373520100256,3.83976473880466,20.2625714046881,3.50692129402887,6.1153180024121,16.3960302554769,4.35019643127453,23.2441339484649,21.203205587226,3.8610315984115,20.2866412595613,18.7836005769204,22.8854866056936,27.088179970975,5.264587626094,18.3404029597295,14.527759552002,5.06886911729816,26.6869349632179,22.4262562860968,16.1937407588121,17.0459635030711,1.39626178541221,20.66252437816,28.3058238453232,29.6848021540791,25.2504637937527,15.34168170474,29.946743110544,22.3559718601173,19.0571762433974,15.31783441687,28.7458214127691,24.2065845327452,29.2571131999139,15.0187117687892,4.76007031311747,12.5153904234758,14.5087352520786,11.2198595821392,25.9821229663212,21.6506575283129,6.4720628245268,4.24790070368908,5.1569665275747,0.734228026471101,0.941558283870108,7.64603789069224,24.9687637860188,29.6571442201966,4.24766557419207,6.51292848633602,27.0340559122851,26.8311230565887,19.6597160785459,20.0001456966856,16.5032820070628,18.2377258172492,6.80571285146289,27.3295367559185,29.3418945445446,29.2027902705595,11.5928444667952,17.0259702014737,2.62096581561491,23.883049930213,14.2552872007946,24.135972431046,19.8270985878771,16.1600287469337,19.4163691377034,20.5598091154825,15.5006589235272,23.406616041204,14.6354723862605,5.87887315254193,9.39602240547538,5.2075066214893,29.5593250606908,13.5683690854348,9.17646714509465,8.24834192323033,2.39427333476488,15.7790715965675,10.7587843342917,22.1871573020471,9.90624851675238,18.1421047576005,9.29909628885798,0.681750416872092,16.3310107438592,1.75171905150637,17.5277121923864,18.1137811763911,17.5565039514331,15.9952259927522,11.368838656228,13.9546246615937,25.6012841946213,5.69594295334537,14.9603882243391,22.5850199974375,25.2679184138542,15.3344487167196,9.68421914568171,22.4306835863972,1.60252538474742,8.18451295001432,12.8449455513619,29.8244806762086,13.6011708488222,0.642044000560418,11.5974802674027,23.7849810112966,22.5206403419143,19.2488505495712,26.7341761764837,19.4351915448206,8.17358681547921,28.3524442625931,26.078241120209,13.2003988886718,23.6979059366276,8.15902347839437,20.3678154238733,1.14279670710675,27.5778349952307,29.6442146804184,5.95964831172023,6.81212968262844,13.7865545463283,14.9632191744167,1.02475632843561,7.57526794390287,19.4992576874793,25.9843898748513,0.533059291075915,16.2928028771421,6.02606612711679,10.5429959332105,7.60432968323585,27.5624637778383,21.3856201266171,6.42371952545363,20.7413275417639,23.6101749747759],"z":[11.7694227799599,2.85408147801992,17.1778034757926,6.81664690867892,4.06222352243168,9.55004599703223,7.62450698041603,15.8546544341453,3.06746173004763,12.0984843702583,6.43024815108675,8.60827207541993,6.72252380072458,10.5978071174237,14.0794783264219,8.74484530505964,5.44334202544307,9.16230641709494,9.74718576998492,5.85827788202521,11.7247415950836,16.028187666264,15.0007154262729,16.4882059298418,12.3566075407919,9.08844485083311,3.21721427503126,6.59371914791304,6.65942020997238,11.4829370763788,7.98222748153378,7.72246246621572,12.1648166466635,8.02740434077529,13.4165474256556,15.0873602306266,5.27986337654166,13.5076191559019,15.9929864351303,7.04062106502165,13.2385261957841,11.53573538121,12.8868167771747,10.8944570773546,13.4660327411507,12.3288988994328,14.4157831080667,6.80935463626214,11.3683650382505,14.8253623456031,0.683926390933251,9.08884928739137,4.25648339455707,17.8341328278145,17.4118109159292,10.0558054630651,15.0086341011064,10.8936852462994,5.30681799949047,11.0243251791491,8.76392965163116,14.6003016132045,13.8021255059446,11.6320722811067,7.4630017410586,17.7101909518723,13.266384972088,15.3003823863531,11.7531561510947,16.1991180384793,5.68568185248101,2.90598716811847,14.1798441550381,9.46602603949768,18.7669334230493,16.3479313039816,12.046643233447,13.3730054728844,6.73577092016331,6.51670364512068,4.56689452567824,12.379073424809,11.1407355007726,14.329975883697,17.8776919720104,14.9359167492126,13.7579866608137,14.4789601185203,12.7945548491403,8.33171807008686,18.6897979311701,13.4876888717466,10.2648899192485,13.1737409698646,6.0724854602172,6.3567191693786,13.7996830434886,18.4623513180431,6.58268507904181,14.8556848453271,4.36160617054341,7.70739764235553,10.5260292802398,14.3914483621106,7.81638863780601,11.6647648408331,6.26457436225485,10.9117654596216,8.70019787593581,1.96644819198129,14.5878252598517,6.55933582279416,5.75365362826554,14.8517766239557,19.2426878407104,14.4293484457953,14.4114829581134,15.1981843157351,11.5075951455664,15.5763683376215,4.04424691092626,10.542790173343,7.29927744046323,13.6191300065453,4.0907648387677,15.8685827807889,14.8303439589133,6.07379227677217,15.1389680449694,13.5250712447217,3.77438796683585,14.6357693245841,3.74449837382852,6.0015226708052,5.23573120255346,13.0038422884333,2.98906770183855,5.52393102336802,11.374289815669,13.5987547533393,12.9216725851983,14.5243489099665,5.72682702460553,10.6355905027589,7.57261422706346,3.66842730828419,10.1067938305787,9.59909405152255,7.65818703984018,8.87398468628214,17.7585948067489,12.0931243798311,4.50022730018201,12.8126370645201,4.91638344750468,7.59179727844881,3.03743176946628,8.05119510725396,8.51992786276076,18.4829597730049,8.93658293764611,15.9085493232313,13.2582034694961,6.33502153456202,9.75189421804246,2.82835670446603,7.44941257611164,3.89710985052363,18.688130424111,9.38790782261998,11.2860570447172,5.80949454425725,14.8048065218688,7.47437197641209,11.5622807716992,13.3774299584275,2.35480848785242,9.86172883177327,15.6431142130052,5.54190662661349,5.41591738775797,12.6884954279176,7.59016603812758,1.8701099622522,16.7460356063431,9.79848335492426,12.8178071154014,9.39263934124846,16.0139208457783,11.5360652135106,10.2505846712463,8.82823613948537,9.77538589437434,14.5477545225499,6.94429747903472,2.70846055799451,4.94799078575802,15.3662877208841,9.54365567619043,16.2725863339272,12.5158362038087,17.4485159635828,14.5572878830913,5.56092164375352,11.5562573440202,8.50374630085641,2.55115063030718,8.49503388540925,17.5604513545621,6.73908069736794,17.3545770884133,11.5999032196752,14.9407560188416,2.23921693256614,20.453496225445,4.97346133339796,10.6947888564578,2.18565078415202,4.0768234724376,7.28625237684101,3.52297632250865,16.7786345605248,5.07307463780323,11.3729971514119,5.69064886218421,12.5378280980537,4.93457828454242,6.66207531664114,12.0465147076596,11.2963161593988,16.3351186365068,14.0886540104569,7.64502484417374,13.6443725840347,4.59004813484523,7.82553586873759,10.7150869366663,16.3846780226745,6.83818466809348,13.995989499996,17.5981660940916,7.62066293512988,16.7368633119264,15.5694793547691,6.29449879793774,13.28152870795,8.14348509973927,12.9964758200146,9.23007425053153,8.93789315703228,10.5460250889721,11.4380099666309,12.1611678270885,13.2060430352839,9.5946227201472,1.68572274791051,7.4925557688149,15.4418923336385,8.89610389234905,11.1773178322918,0.712181916179002,9.83547442700765,3.11815173135627,17.1060395234265,11.9488892956875,0.98753644616469,1.10482035847264,11.2714178078503,11.600939430618,3.83534506468451,2.20165296992966,9.51338390554353,12.1074099626716,7.23106925350839,9.90497129413159,4.68009745231397,14.6563521056647,9.32447394779634,11.1056305679118,11.729570337135,5.33403738664762,4.84192795476122,6.26170380720501,20.1852906112353,6.857174313794,13.6432671178381,12.7512095115407,10.8655224373347,5.8429680389224,7.61880346690322,13.7798359548202,10.1749400180093,15.1727163787361,5.795598225413,10.3819438154469,11.8208854287917,6.22378443100166,13.9029794167697,6.95205496269696,16.6418807402838,9.09574855190076,11.7785961614611,10.2335875156303,6.57305075498681,5.31909408076634,12.3513903418629,11.4296859769554,2.06286191420641,4.1138786249241,4.59117284105,11.385209086582,6.55857961972861,10.9717608456486,4.6269658626729,9.90492086081358,10.7042341943676,10.3775690768213,11.4335113098276,15.2399654583376,8.26898314632451,19.4319600799512,5.47890872455847,6.80839968380668,10.7291814979495,0.704996051376646,8.31089765646969,16.7913827564307,17.3705338278606,12.7344968499666,8.88586328086767,14.2983625302645,8.54909495405246,3.29621776830647,15.9893713607311,11.6298289788999,14.4080750059789,15.9778522374575,14.4437736916377,15.5885429615858,16.5178715195227,9.23197066623804,11.2694842818891,14.4660128371567,14.4858120944068,10.8115182996014,14.4343940097234,16.9616280060376,13.7241182651575,4.06609481307562,17.6180620028488,8.99763659338988,4.94609016469441,6.06098859619984,15.1627752380115,3.6893644611366,2.71866414543762,11.543719212996,5.71773344209276,13.6273518240686,13.6705821133172,6.71507793145795,5.32612719044283,4.52427598155646,11.8311383167185,7.32233218611327,16.6098257073013,11.058305512326,16.3756622084764,10.0490669351684,6.50794745496118,15.1165636423551,17.2692333466867,2.91165988628036,5.90544578900517,11.7697859477111,13.7515774784347,17.0171582538802,17.2139369001266,13.1917033102912,10.3885655125526,17.857848701604,10.503688957045,2.8284840654209,4.48099302324631,13.0160451212521,7.18494636895327,7.33037569537936,4.63151663986019,10.3661423214816,3.45302671653793,9.509418430781,2.65470613376857,8.85410742045843,15.0308207313916,3.34913788937639,3.39784331797622,7.14917870236625,3.233833216746,0.554697106726739,3.59867873985282,5.85051695747973,16.2651029713863,7.25794619091204,11.577671608504,18.6396921685775,16.1647939478636,17.0589358601441,7.93060122486964,16.5272933093538,11.5944099145801,15.8369336070558,18.6734573347373,14.9898130004558,13.7702315557131,11.4241148503831,8.34557353802631,5.8095430500864,6.95950198934831,17.1337445943087,19.5817259947379,13.175000676514,13.6480773098798,4.11321881605699,7.50061184583686,13.3798074157422,14.0716450387572,4.69552052825815,2.97876856048482,9.57189124703549,14.8081495627487,8.57058330334775,4.18477014500711,16.4996389448518,9.78016512052607,9.44689881998868,6.03601293855265,13.3344280610091,13.2836703344724,3.40208037539644,11.658570800755,1.57342899767088,8.55785408004805,13.7196389912139,14.0074901426061,14.8979608722867,13.193175287052,12.062814680611,12.0749260026238,5.07228124478768,13.4705063259895,13.7237396272048,1.09448871359267,15.5819985789236,4.29637700753309,12.5665225056865,7.01599017785655,5.72813493592136,5.35697519337091,6.78523430629403,9.79323987990112,3.26340215539601,13.3703391556823,8.86792508470685,0.551898154405674,8.46295231231504,5.97642760376509,4.3031890139167,6.51267555604405,17.4739403216237,17.7621148428917,4.93805892901859,10.1612020576676,4.63139832043117,12.358035158831,11.2829461601657,10.887413420699,7.66534591503176,12.7884505407033,18.5036637267043,18.0812684150877,5.35161923221787,10.3723286818467,9.7315448037669,6.91625863946672,10.8938935976695,7.83138474916485,13.7706393561387,6.75601545501116,5.92568028868302,4.70700935960851,5.58549322827601,3.10933774980765,12.3736909611561,11.2943915753777,9.61676248475798,13.4951676503312,10.115865147358,11.843555763502],"type":"scatter3d","mode":"markers","marker":{"colorbar":{"title":"heart.disease","ticklen":2},"cmin":0.551898154405674,"cmax":20.453496225445,"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333333","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":false,"color":[11.7694227799599,2.85408147801992,17.1778034757926,6.81664690867892,4.06222352243168,9.55004599703223,7.62450698041603,15.8546544341453,3.06746173004763,12.0984843702583,6.43024815108675,8.60827207541993,6.72252380072458,10.5978071174237,14.0794783264219,8.74484530505964,5.44334202544307,9.16230641709494,9.74718576998492,5.85827788202521,11.7247415950836,16.028187666264,15.0007154262729,16.4882059298418,12.3566075407919,9.08844485083311,3.21721427503126,6.59371914791304,6.65942020997238,11.4829370763788,7.98222748153378,7.72246246621572,12.1648166466635,8.02740434077529,13.4165474256556,15.0873602306266,5.27986337654166,13.5076191559019,15.9929864351303,7.04062106502165,13.2385261957841,11.53573538121,12.8868167771747,10.8944570773546,13.4660327411507,12.3288988994328,14.4157831080667,6.80935463626214,11.3683650382505,14.8253623456031,0.683926390933251,9.08884928739137,4.25648339455707,17.8341328278145,17.4118109159292,10.0558054630651,15.0086341011064,10.8936852462994,5.30681799949047,11.0243251791491,8.76392965163116,14.6003016132045,13.8021255059446,11.6320722811067,7.4630017410586,17.7101909518723,13.266384972088,15.3003823863531,11.7531561510947,16.1991180384793,5.68568185248101,2.90598716811847,14.1798441550381,9.46602603949768,18.7669334230493,16.3479313039816,12.046643233447,13.3730054728844,6.73577092016331,6.51670364512068,4.56689452567824,12.379073424809,11.1407355007726,14.329975883697,17.8776919720104,14.9359167492126,13.7579866608137,14.4789601185203,12.7945548491403,8.33171807008686,18.6897979311701,13.4876888717466,10.2648899192485,13.1737409698646,6.0724854602172,6.3567191693786,13.7996830434886,18.4623513180431,6.58268507904181,14.8556848453271,4.36160617054341,7.70739764235553,10.5260292802398,14.3914483621106,7.81638863780601,11.6647648408331,6.26457436225485,10.9117654596216,8.70019787593581,1.96644819198129,14.5878252598517,6.55933582279416,5.75365362826554,14.8517766239557,19.2426878407104,14.4293484457953,14.4114829581134,15.1981843157351,11.5075951455664,15.5763683376215,4.04424691092626,10.542790173343,7.29927744046323,13.6191300065453,4.0907648387677,15.8685827807889,14.8303439589133,6.07379227677217,15.1389680449694,13.5250712447217,3.77438796683585,14.6357693245841,3.74449837382852,6.0015226708052,5.23573120255346,13.0038422884333,2.98906770183855,5.52393102336802,11.374289815669,13.5987547533393,12.9216725851983,14.5243489099665,5.72682702460553,10.6355905027589,7.57261422706346,3.66842730828419,10.1067938305787,9.59909405152255,7.65818703984018,8.87398468628214,17.7585948067489,12.0931243798311,4.50022730018201,12.8126370645201,4.91638344750468,7.59179727844881,3.03743176946628,8.05119510725396,8.51992786276076,18.4829597730049,8.93658293764611,15.9085493232313,13.2582034694961,6.33502153456202,9.75189421804246,2.82835670446603,7.44941257611164,3.89710985052363,18.688130424111,9.38790782261998,11.2860570447172,5.80949454425725,14.8048065218688,7.47437197641209,11.5622807716992,13.3774299584275,2.35480848785242,9.86172883177327,15.6431142130052,5.54190662661349,5.41591738775797,12.6884954279176,7.59016603812758,1.8701099622522,16.7460356063431,9.79848335492426,12.8178071154014,9.39263934124846,16.0139208457783,11.5360652135106,10.2505846712463,8.82823613948537,9.77538589437434,14.5477545225499,6.94429747903472,2.70846055799451,4.94799078575802,15.3662877208841,9.54365567619043,16.2725863339272,12.5158362038087,17.4485159635828,14.5572878830913,5.56092164375352,11.5562573440202,8.50374630085641,2.55115063030718,8.49503388540925,17.5604513545621,6.73908069736794,17.3545770884133,11.5999032196752,14.9407560188416,2.23921693256614,20.453496225445,4.97346133339796,10.6947888564578,2.18565078415202,4.0768234724376,7.28625237684101,3.52297632250865,16.7786345605248,5.07307463780323,11.3729971514119,5.69064886218421,12.5378280980537,4.93457828454242,6.66207531664114,12.0465147076596,11.2963161593988,16.3351186365068,14.0886540104569,7.64502484417374,13.6443725840347,4.59004813484523,7.82553586873759,10.7150869366663,16.3846780226745,6.83818466809348,13.995989499996,17.5981660940916,7.62066293512988,16.7368633119264,15.5694793547691,6.29449879793774,13.28152870795,8.14348509973927,12.9964758200146,9.23007425053153,8.93789315703228,10.5460250889721,11.4380099666309,12.1611678270885,13.2060430352839,9.5946227201472,1.68572274791051,7.4925557688149,15.4418923336385,8.89610389234905,11.1773178322918,0.712181916179002,9.83547442700765,3.11815173135627,17.1060395234265,11.9488892956875,0.98753644616469,1.10482035847264,11.2714178078503,11.600939430618,3.83534506468451,2.20165296992966,9.51338390554353,12.1074099626716,7.23106925350839,9.90497129413159,4.68009745231397,14.6563521056647,9.32447394779634,11.1056305679118,11.729570337135,5.33403738664762,4.84192795476122,6.26170380720501,20.1852906112353,6.857174313794,13.6432671178381,12.7512095115407,10.8655224373347,5.8429680389224,7.61880346690322,13.7798359548202,10.1749400180093,15.1727163787361,5.795598225413,10.3819438154469,11.8208854287917,6.22378443100166,13.9029794167697,6.95205496269696,16.6418807402838,9.09574855190076,11.7785961614611,10.2335875156303,6.57305075498681,5.31909408076634,12.3513903418629,11.4296859769554,2.06286191420641,4.1138786249241,4.59117284105,11.385209086582,6.55857961972861,10.9717608456486,4.6269658626729,9.90492086081358,10.7042341943676,10.3775690768213,11.4335113098276,15.2399654583376,8.26898314632451,19.4319600799512,5.47890872455847,6.80839968380668,10.7291814979495,0.704996051376646,8.31089765646969,16.7913827564307,17.3705338278606,12.7344968499666,8.88586328086767,14.2983625302645,8.54909495405246,3.29621776830647,15.9893713607311,11.6298289788999,14.4080750059789,15.9778522374575,14.4437736916377,15.5885429615858,16.5178715195227,9.23197066623804,11.2694842818891,14.4660128371567,14.4858120944068,10.8115182996014,14.4343940097234,16.9616280060376,13.7241182651575,4.06609481307562,17.6180620028488,8.99763659338988,4.94609016469441,6.06098859619984,15.1627752380115,3.6893644611366,2.71866414543762,11.543719212996,5.71773344209276,13.6273518240686,13.6705821133172,6.71507793145795,5.32612719044283,4.52427598155646,11.8311383167185,7.32233218611327,16.6098257073013,11.058305512326,16.3756622084764,10.0490669351684,6.50794745496118,15.1165636423551,17.2692333466867,2.91165988628036,5.90544578900517,11.7697859477111,13.7515774784347,17.0171582538802,17.2139369001266,13.1917033102912,10.3885655125526,17.857848701604,10.503688957045,2.8284840654209,4.48099302324631,13.0160451212521,7.18494636895327,7.33037569537936,4.63151663986019,10.3661423214816,3.45302671653793,9.509418430781,2.65470613376857,8.85410742045843,15.0308207313916,3.34913788937639,3.39784331797622,7.14917870236625,3.233833216746,0.554697106726739,3.59867873985282,5.85051695747973,16.2651029713863,7.25794619091204,11.577671608504,18.6396921685775,16.1647939478636,17.0589358601441,7.93060122486964,16.5272933093538,11.5944099145801,15.8369336070558,18.6734573347373,14.9898130004558,13.7702315557131,11.4241148503831,8.34557353802631,5.8095430500864,6.95950198934831,17.1337445943087,19.5817259947379,13.175000676514,13.6480773098798,4.11321881605699,7.50061184583686,13.3798074157422,14.0716450387572,4.69552052825815,2.97876856048482,9.57189124703549,14.8081495627487,8.57058330334775,4.18477014500711,16.4996389448518,9.78016512052607,9.44689881998868,6.03601293855265,13.3344280610091,13.2836703344724,3.40208037539644,11.658570800755,1.57342899767088,8.55785408004805,13.7196389912139,14.0074901426061,14.8979608722867,13.193175287052,12.062814680611,12.0749260026238,5.07228124478768,13.4705063259895,13.7237396272048,1.09448871359267,15.5819985789236,4.29637700753309,12.5665225056865,7.01599017785655,5.72813493592136,5.35697519337091,6.78523430629403,9.79323987990112,3.26340215539601,13.3703391556823,8.86792508470685,0.551898154405674,8.46295231231504,5.97642760376509,4.3031890139167,6.51267555604405,17.4739403216237,17.7621148428917,4.93805892901859,10.1612020576676,4.63139832043117,12.358035158831,11.2829461601657,10.887413420699,7.66534591503176,12.7884505407033,18.5036637267043,18.0812684150877,5.35161923221787,10.3723286818467,9.7315448037669,6.91625863946672,10.8938935976695,7.83138474916485,13.7706393561387,6.75601545501116,5.92568028868302,4.70700935960851,5.58549322827601,3.10933774980765,12.3736909611561,11.2943915753777,9.61676248475798,13.4951676503312,10.115865147358,11.843555763502],"line":{"colorbar":{"title":"","ticklen":2},"cmin":0.551898154405674,"cmax":20.453496225445,"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333333","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":false,"color":[11.7694227799599,2.85408147801992,17.1778034757926,6.81664690867892,4.06222352243168,9.55004599703223,7.62450698041603,15.8546544341453,3.06746173004763,12.0984843702583,6.43024815108675,8.60827207541993,6.72252380072458,10.5978071174237,14.0794783264219,8.74484530505964,5.44334202544307,9.16230641709494,9.74718576998492,5.85827788202521,11.7247415950836,16.028187666264,15.0007154262729,16.4882059298418,12.3566075407919,9.08844485083311,3.21721427503126,6.59371914791304,6.65942020997238,11.4829370763788,7.98222748153378,7.72246246621572,12.1648166466635,8.02740434077529,13.4165474256556,15.0873602306266,5.27986337654166,13.5076191559019,15.9929864351303,7.04062106502165,13.2385261957841,11.53573538121,12.8868167771747,10.8944570773546,13.4660327411507,12.3288988994328,14.4157831080667,6.80935463626214,11.3683650382505,14.8253623456031,0.683926390933251,9.08884928739137,4.25648339455707,17.8341328278145,17.4118109159292,10.0558054630651,15.0086341011064,10.8936852462994,5.30681799949047,11.0243251791491,8.76392965163116,14.6003016132045,13.8021255059446,11.6320722811067,7.4630017410586,17.7101909518723,13.266384972088,15.3003823863531,11.7531561510947,16.1991180384793,5.68568185248101,2.90598716811847,14.1798441550381,9.46602603949768,18.7669334230493,16.3479313039816,12.046643233447,13.3730054728844,6.73577092016331,6.51670364512068,4.56689452567824,12.379073424809,11.1407355007726,14.329975883697,17.8776919720104,14.9359167492126,13.7579866608137,14.4789601185203,12.7945548491403,8.33171807008686,18.6897979311701,13.4876888717466,10.2648899192485,13.1737409698646,6.0724854602172,6.3567191693786,13.7996830434886,18.4623513180431,6.58268507904181,14.8556848453271,4.36160617054341,7.70739764235553,10.5260292802398,14.3914483621106,7.81638863780601,11.6647648408331,6.26457436225485,10.9117654596216,8.70019787593581,1.96644819198129,14.5878252598517,6.55933582279416,5.75365362826554,14.8517766239557,19.2426878407104,14.4293484457953,14.4114829581134,15.1981843157351,11.5075951455664,15.5763683376215,4.04424691092626,10.542790173343,7.29927744046323,13.6191300065453,4.0907648387677,15.8685827807889,14.8303439589133,6.07379227677217,15.1389680449694,13.5250712447217,3.77438796683585,14.6357693245841,3.74449837382852,6.0015226708052,5.23573120255346,13.0038422884333,2.98906770183855,5.52393102336802,11.374289815669,13.5987547533393,12.9216725851983,14.5243489099665,5.72682702460553,10.6355905027589,7.57261422706346,3.66842730828419,10.1067938305787,9.59909405152255,7.65818703984018,8.87398468628214,17.7585948067489,12.0931243798311,4.50022730018201,12.8126370645201,4.91638344750468,7.59179727844881,3.03743176946628,8.05119510725396,8.51992786276076,18.4829597730049,8.93658293764611,15.9085493232313,13.2582034694961,6.33502153456202,9.75189421804246,2.82835670446603,7.44941257611164,3.89710985052363,18.688130424111,9.38790782261998,11.2860570447172,5.80949454425725,14.8048065218688,7.47437197641209,11.5622807716992,13.3774299584275,2.35480848785242,9.86172883177327,15.6431142130052,5.54190662661349,5.41591738775797,12.6884954279176,7.59016603812758,1.8701099622522,16.7460356063431,9.79848335492426,12.8178071154014,9.39263934124846,16.0139208457783,11.5360652135106,10.2505846712463,8.82823613948537,9.77538589437434,14.5477545225499,6.94429747903472,2.70846055799451,4.94799078575802,15.3662877208841,9.54365567619043,16.2725863339272,12.5158362038087,17.4485159635828,14.5572878830913,5.56092164375352,11.5562573440202,8.50374630085641,2.55115063030718,8.49503388540925,17.5604513545621,6.73908069736794,17.3545770884133,11.5999032196752,14.9407560188416,2.23921693256614,20.453496225445,4.97346133339796,10.6947888564578,2.18565078415202,4.0768234724376,7.28625237684101,3.52297632250865,16.7786345605248,5.07307463780323,11.3729971514119,5.69064886218421,12.5378280980537,4.93457828454242,6.66207531664114,12.0465147076596,11.2963161593988,16.3351186365068,14.0886540104569,7.64502484417374,13.6443725840347,4.59004813484523,7.82553586873759,10.7150869366663,16.3846780226745,6.83818466809348,13.995989499996,17.5981660940916,7.62066293512988,16.7368633119264,15.5694793547691,6.29449879793774,13.28152870795,8.14348509973927,12.9964758200146,9.23007425053153,8.93789315703228,10.5460250889721,11.4380099666309,12.1611678270885,13.2060430352839,9.5946227201472,1.68572274791051,7.4925557688149,15.4418923336385,8.89610389234905,11.1773178322918,0.712181916179002,9.83547442700765,3.11815173135627,17.1060395234265,11.9488892956875,0.98753644616469,1.10482035847264,11.2714178078503,11.600939430618,3.83534506468451,2.20165296992966,9.51338390554353,12.1074099626716,7.23106925350839,9.90497129413159,4.68009745231397,14.6563521056647,9.32447394779634,11.1056305679118,11.729570337135,5.33403738664762,4.84192795476122,6.26170380720501,20.1852906112353,6.857174313794,13.6432671178381,12.7512095115407,10.8655224373347,5.8429680389224,7.61880346690322,13.7798359548202,10.1749400180093,15.1727163787361,5.795598225413,10.3819438154469,11.8208854287917,6.22378443100166,13.9029794167697,6.95205496269696,16.6418807402838,9.09574855190076,11.7785961614611,10.2335875156303,6.57305075498681,5.31909408076634,12.3513903418629,11.4296859769554,2.06286191420641,4.1138786249241,4.59117284105,11.385209086582,6.55857961972861,10.9717608456486,4.6269658626729,9.90492086081358,10.7042341943676,10.3775690768213,11.4335113098276,15.2399654583376,8.26898314632451,19.4319600799512,5.47890872455847,6.80839968380668,10.7291814979495,0.704996051376646,8.31089765646969,16.7913827564307,17.3705338278606,12.7344968499666,8.88586328086767,14.2983625302645,8.54909495405246,3.29621776830647,15.9893713607311,11.6298289788999,14.4080750059789,15.9778522374575,14.4437736916377,15.5885429615858,16.5178715195227,9.23197066623804,11.2694842818891,14.4660128371567,14.4858120944068,10.8115182996014,14.4343940097234,16.9616280060376,13.7241182651575,4.06609481307562,17.6180620028488,8.99763659338988,4.94609016469441,6.06098859619984,15.1627752380115,3.6893644611366,2.71866414543762,11.543719212996,5.71773344209276,13.6273518240686,13.6705821133172,6.71507793145795,5.32612719044283,4.52427598155646,11.8311383167185,7.32233218611327,16.6098257073013,11.058305512326,16.3756622084764,10.0490669351684,6.50794745496118,15.1165636423551,17.2692333466867,2.91165988628036,5.90544578900517,11.7697859477111,13.7515774784347,17.0171582538802,17.2139369001266,13.1917033102912,10.3885655125526,17.857848701604,10.503688957045,2.8284840654209,4.48099302324631,13.0160451212521,7.18494636895327,7.33037569537936,4.63151663986019,10.3661423214816,3.45302671653793,9.509418430781,2.65470613376857,8.85410742045843,15.0308207313916,3.34913788937639,3.39784331797622,7.14917870236625,3.233833216746,0.554697106726739,3.59867873985282,5.85051695747973,16.2651029713863,7.25794619091204,11.577671608504,18.6396921685775,16.1647939478636,17.0589358601441,7.93060122486964,16.5272933093538,11.5944099145801,15.8369336070558,18.6734573347373,14.9898130004558,13.7702315557131,11.4241148503831,8.34557353802631,5.8095430500864,6.95950198934831,17.1337445943087,19.5817259947379,13.175000676514,13.6480773098798,4.11321881605699,7.50061184583686,13.3798074157422,14.0716450387572,4.69552052825815,2.97876856048482,9.57189124703549,14.8081495627487,8.57058330334775,4.18477014500711,16.4996389448518,9.78016512052607,9.44689881998868,6.03601293855265,13.3344280610091,13.2836703344724,3.40208037539644,11.658570800755,1.57342899767088,8.55785408004805,13.7196389912139,14.0074901426061,14.8979608722867,13.193175287052,12.062814680611,12.0749260026238,5.07228124478768,13.4705063259895,13.7237396272048,1.09448871359267,15.5819985789236,4.29637700753309,12.5665225056865,7.01599017785655,5.72813493592136,5.35697519337091,6.78523430629403,9.79323987990112,3.26340215539601,13.3703391556823,8.86792508470685,0.551898154405674,8.46295231231504,5.97642760376509,4.3031890139167,6.51267555604405,17.4739403216237,17.7621148428917,4.93805892901859,10.1612020576676,4.63139832043117,12.358035158831,11.2829461601657,10.887413420699,7.66534591503176,12.7884505407033,18.5036637267043,18.0812684150877,5.35161923221787,10.3723286818467,9.7315448037669,6.91625863946672,10.8938935976695,7.83138474916485,13.7706393561387,6.75601545501116,5.92568028868302,4.70700935960851,5.58549322827601,3.10933774980765,12.3736909611561,11.2943915753777,9.61676248475798,13.4951676503312,10.115865147358,11.843555763502]}},"frame":null},{"x":[1.11915412219241,74.9071108056232],"y":[0.525849992525764,29.946743110544],"type":"scatter3d","mode":"markers","opacity":0,"hoverinfo":"none","showlegend":false,"marker":{"colorbar":{"title":"heart.disease","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"cmin":0.551898154405674,"cmax":20.453496225445,"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333333","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":true,"color":[0.551898154405674,20.453496225445],"line":{"color":"rgba(255,127,14,1)"}},"z":[0.551898154405674,20.453496225445],"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
```

<p class="caption">(\#fig:nuage3d)Nuage de points en 3D</p>
</div>

 Une représentation 3 dimensions plus simple peut être faite avec la fonction `scatterplot3d()` du package de même nom.

```r
library(scatterplot3d)
scatterplot3d(x =heart_data[,"biking"],
                         y = heart_data[,"smoking"],
                         z= heart_data[,"heart.disease"], type="p",pch=16,box=FALSE,
                         xlab="biking",ylab="smoking",zlab="heart.disease")
```

<img src="04-multiple-lm_files/figure-html/unnamed-chunk-5-1.png" width="576" />
 

### Droite de régression

La représentation de la droite de régression peut se faire sur chaque dimension des variables explicative grâce à la fonction `avPlots()` de la libraire car


```r
library(car)
avPlots(lm_multiple)
```

<div class="figure">
<img src="04-multiple-lm_files/figure-html/lm_multiple-1.png" alt="Cette représentation confirme notre interprétation. On voit clairement une corrélation entre les variables explicatives et $y$ mais pas entre l’interaction de ces variable et $y$" width="672" />
<p class="caption">(\#fig:lm_multiple)Cette représentation confirme notre interprétation. On voit clairement une corrélation entre les variables explicatives et $y$ mais pas entre l’interaction de ces variable et $y$</p>
</div>
## Prédiction
La prédiction dans le modèle linéaire multiple se fait aussi avec la fonction `predict()` comme dans le cas simple. On peut reprendre l'entraînement de notre modèle avec $80\%$ de nos données soient 400 observations et utiliser les $20\%$ pour effectuer une prédiction. Cela peut nous permettre de voir les résidus entre les valeurs prédites et les valeurs réelles de $y$.


```r
set.seed(2345)
echantillon = sample(1:498)[1:100]
data_train <- heart_data[-echantillon,]
data_test <- heart_data[echantillon,]
model <- lm(heart.disease~.,data = data_test)
# Prediction
y_predict <- predict(model,data_test[,-3])
y_predict[1:10]
#>       483       494       359       211       418       335 
#> 10.222660 10.432554 13.843535 16.974577  6.824394 12.325991 
#>       204       475        67        66 
#>  5.947508 12.011159 12.926691 18.413173
```

On peut visualiser les résidus entre les variables $y_i$ observés et les $y_i$ prédites :


```r
library(ggplot2)
y_test = data_test$heart.disease
ggplot() +
  geom_point(aes(x = y_test, y = y_predict)) +
  geom_abline(slope = 1, color ='darkred') +
  geom_segment(aes(x =y_test , 
                   y = y_test, xend = y_test, yend = y_predict),
               color = 'red') +
  ylab("Predicted heart disease")+xlab("Heart disease")
```

<div class="figure">
<img src="04-multiple-lm_files/figure-html/unnamed-chunk-7-1.png" alt="Les résidus sont très proches de 0 cela qui reflète la bonne qualité du modèle." width="672" />
<p class="caption">(\#fig:unnamed-chunk-7)Les résidus sont très proches de 0 cela qui reflète la bonne qualité du modèle.</p>
</div>


